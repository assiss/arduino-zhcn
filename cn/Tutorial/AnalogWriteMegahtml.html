<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
  <title>Arduino - AnalogWriteMega </title>
  <link rel="shortcut icon" type="image/x-icon" href="../favicon.png">
  <link rel='stylesheet' href='../pub/skins/arduinoWide_SSO/arduinoWide_SSO.css' 
type='text/css' />
  <link href="https://plus.google.com/114839908922424087554" rel="publisher" />
    <!--HeaderText--><style type='text/css'><!--
  ul, ol, pre, dl, p { margin-top:0px; margin-bottom:0px; }
  code { white-space: nowrap; }
  .vspace { margin-top:1.33em; }
  .indent { margin-left:40px; }
  .outdent { margin-left:40px; text-indent:-40px; }
  a.createlinktext { text-decoration:none; border-bottom:1px dotted gray; }
  a.createlink { text-decoration:none; position:relative; top:-0.5em;
    font-weight:bold; font-size:smaller; border-bottom:none; }
  img { border:0px; }
  
span.anchor {
	float: left;
	font-size: 10px;
	margin-left: -10px;
	width: 10px;
    position:relative; top:-0.1em;
	text-align: center;
}
span.anchor a { text-decoration: none; }
span.anchor a:hover { text-decoration: underline; }
ol.toc { text-indent:-20px; list-style: none; }
ol.toc ol.toc { text-indent:-40px; }
div.tocfloat { font-size: smaller; margin-bottom: 10px;
    border-top: 1px dotted #555555; border-bottom: 1px dotted #555555;
    padding-top: 5px; padding-bottom: 5px; 
    width: 38%; float: right; margin-left: 10px; clear: right;
    margin-right:-13px; padding-right: 13px; padding-left: 13px;
    background-color: #eeeeee; }
div.toc { font-size: smaller; 
    padding: 5px; border: 1px dotted #cccccc;
    background: #f7f7f7;
    margin-bottom: 10px; }
div.toc p { background-color: #f9f6d6;
    margin-top:-5px;   padding-top: 5px;
    margin-left:-5px;  padding-left: 5px;
    margin-right:-5px; padding-right: 5px;
    padding-bottom: 3px;
    border-bottom:  1px dotted #cccccc; }.editconflict { color:green; 
  font-style:italic; margin-top:1.33em; margin-bottom:1.33em; }

  table.markup { border: 2px dotted #ccf; width:90%; }
  td.markup1, td.markup2 { padding-left:10px; padding-right:10px; }
  td.markup1 { border-bottom: 1px solid #ccf; }
  div.faq { margin-left:2em; }
  div.faq p.question { margin: 1em 0 0.75em -2em; font-weight:bold; }
  div.faq hr { margin-left: -2em; }
   
    .frame 
      { border:1px solid #cccccc; padding:4px; background-color:#f9f9f9; }
    .lfloat { float:left; margin-right:0.5em; }
    .rfloat { float:right; margin-left:0.5em; }
a.varlink { text-decoration:none; }
/**
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 */
.arduino  {font-family:monospace;}
.arduino .imp {font-weight: bold; color: red;}
.arduino .kw1 {color: #CC6600;}
.arduino .kw2 {color: #006699;}
.arduino .kw3 {color: #CC6600; font-weight: bold;}
.arduino .co1 {color: #7E7E7E; font-style: italic;}
.arduino .co2 {color: #7E7E7E;}
.arduino .coMULTI {color: #7E7E7E; font-style: italic;}
.arduino .es0 {color: #000099; font-weight: bold;}
.arduino .es1 {color: #000099; font-weight: bold;}
.arduino .es2 {color: #660099; font-weight: bold;}
.arduino .es3 {color: #660099; font-weight: bold;}
.arduino .es4 {color: #660099; font-weight: bold;}
.arduino .es5 {color: #006699; font-weight: bold;}
.arduino .br0 {color: #000000;}
.arduino .sy0 {color: #000000;}
.arduino .st0 {color: #0066CC;}
.arduino .nu0 {color: #000000;}
.arduino .nu6 {color: #208080;}
.arduino .nu8 {color: #208080;}
.arduino .nu12 {color: #208080;}
.arduino .nu16 {color:#800080;}
.arduino .nu17 {color:#800080;}
.arduino .nu18 {color:#800080;}
.arduino .nu19 {color:#800080;}
.arduino .me1 {color: #ff1493;}
.arduino .me2 {color: #ff1493;}
.arduino span.xtra { display:block; }

.sourceblocklink {
  text-align: right;
  font-size: smaller;
}
.sourceblocktext {
  padding: 0.5em;
  color: #000000;
  background-color: #ffffff;
}
.sourceblocktext div {
  font-family: monospace;
  font-size: small;
  line-height: 1;
  height: 1%;
}
.sourceblocktext div.head,
.sourceblocktext div.foot {
  font: italic medium serif;
  padding: 0.5em;
}

--></style><script type="text/javascript">
function toggle(obj) {
    var elstyle = document.getElementById(obj).style;
    var text    = document.getElementById(obj + "tog");
    if (elstyle.display == 'none') {
        elstyle.display = 'block';
        text.innerHTML = "hide";
    } else {
        elstyle.display = 'none';
        text.innerHTML = "show";
    }
}
</script>  <meta name='robots' content='index,follow' />

  <meta name="verify-v1" content="TtxFIEJAB6zdJ509wLxjnapQzKAMNm9u0Wj4ho6wxIY=" />
  <script src="https://id.arduino.cc/css/sso_bar_js_2.php?s=reference"></script>
  <link rel="stylesheet" type="text/css" media="screen" href="../../../id.arduino.cc/css/sso_bar.css" />
</head>
<body>

		<div id="ssotoolbar">
		  <div id="al">
			<nobr><div id="ssoNavBar">&nbsp;</div></nobr>
		  </div>
		  <div id="ar">
			<nobr>
			  <div id="loginInfo"><div id="loading">Loading...</div></div>
			</nobr>
		  </div>
		</div>
		<script>ssoGenerateNavigationBar('');</script>
<div id="page">
<!--PageHeaderFmt-->
<div id="pageheader">
  <div class="title"><a href='../../enhtml.html'>Arduino</a></div>
  <div class="search">
    <!-- SiteSearch Google -->
    <FORM method=GET action="http://www.google.com/search">
    <input type=hidden name=ie value=UTF-8>
    <input type=hidden name=oe value=UTF-8>
    <INPUT TYPE=text name=q size=25 maxlength=255 value="">
    <INPUT type=submit name=btnG VALUE="search">
    <input type=hidden name=domains value="http://www.arduino.cc/">
    <input type=hidden name=sitesearch value="http://www.arduino.cc/">
    </FORM>
    <!-- SiteSearch Google -->
  </div>
</div>
<!--/PageHeaderFmt-->
<!--PageLeftFmt-->
<div id="pagenav">
  <div id="navbar">
  	<p><a class='wikilink' href='../Main/Buy.html'>Buy</a>
<a class='wikilink' href='../Main/Software.html'>Download</a>
<a class='wikilink' href='../Guide/HomePagehtml.html'>Getting Started</a>
<a class='wikilink' href='HomePage.html'>Learning</a>
<a class='wikilink' href='../Reference/HomePage.html'>Reference</a>
<a class='wikilink' href='../Main/Hardware.html'>Hardware</a>
<a class='wikilink' href='../Main/FAQ.html'>FAQ</a>
</p>
<p class='vspace'></p>

  </div>
</div>
<!--/PageLeftFmt-->
<div id="pagetext">
<!--PageText-->
<div id='wikitext'>
<p><strong>Learning</strong> &nbsp;  <a class='wikilink' href='HomePage.html'>Examples</a> | <a class='wikilink' href='Foundationshtml.html'>Foundations</a> | <a class='wikilink' href='../Hacking/HomePage.html'>Hacking</a> | <a class='wikilink' href='Links.html'>Links</a>
</p>
<p class='vspace'></p><p><em>Examples &gt; Analog</em>
</p>
<p class='vspace'></p><h3>Analog Write with 12 <span class='wikiword'>LEDs</span> on an Arduino Mega</h3>
<p>This example fades 12  <span class='wikiword'>LEDs</span> up and the down, one by one, on an Arduino Mega board. 
</p>
<p class='vspace'></p><div  class='BOM' >
<h3>Hardware Required</h3>
<ul><li>Arduino Mega Board
</li><li>(12) <span class='wikiword'>LEDs</span>
</li><li>(12) 220 ohm resistors
</li><li>hook up wire
</li><li>breadboard
</li></ul></div>
<p class='vspace'></p><h3>Circuit</h3>
<div  class='circuit' >
<p class='vspace'></p><div><a class='urllink' href='../uploads/Tutorial/arduinomegaPWM_BB.png' rel='nofollow'><img height='250px' src='../uploads/Tutorial/arduinomegaPWM_bb-2.png' alt='' title='' /></a></div>
<p class='vspace'></p><p><span style='font-size:83%'>image developed using <a class='urllink' href='http://www.fritzing.org/' rel='nofollow'>Fritzing</a>. For more circuit examples, see the <a class='urllink' href='http://fritzing.org/projects/' rel='nofollow'>Fritzing project page</a> </span>
</p>
<p class='vspace'></p><p>Connect the longer, positive legs of (anodes) 12 <span class='wikiword'>LEDs</span> to digital pins 2-13 through 220 ohm current limiting resistors. Connect the shorter, negative legs (cathodes) to ground. 
</p>
<p class='vspace'></p></div>
<p class='vspace'></p><h3>Schematic</h3>
<div  class='circuit' >
<div><a class='urllink' href='../uploads/Tutorial/arduinomegaPWM_sch.png' rel='nofollow'><img height='400px' src='../uploads/Tutorial/arduinomegaPWM_sch.png' alt='' title='' /></a></div>
</div>
<p class='vspace'></p><h3>Code</h3>
<p>In the <code>setup()</code> function of the code below, a <a class='wikilink' href='../Reference/For.html'><code>for()</code></a> loop is used to assign digital pins 2-13 of the Mega as outputs.
</p>
<p class='vspace'></p><p>Next, in the <code>loop()</code> function of the program below, a trio of nested <code>for()</code> loops are used. 
</p>
<p class='vspace'></p><p>The first of these loops, 
</p>
<p class='vspace'></p><p>
<div class='sourceblock ' id='sourceblock2'>
  <div class='sourceblocktext'><div class="arduino"><span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw1">int</span> thisPin <span class="sy0">=</span>lowestPin<span class="sy0">;</span> thisPin <span class="sy0">&lt;=</span> highestPin<span class="sy0">;</span> thisPin<span class="sy0">++</span><span class="br0">&#41;</span></div></div>
  <div class='sourceblocklink'><a href='AnalogWriteMega668d.html?action=sourceblock&amp;num=2' type='text/plain'>[Get Code]</a></div>
</div>

</p>
<p class='vspace'></p><p>moves through each of the LEDS one by one, from the lowest pin to the highest. Before this loop is allowed to move from one pin to the next, two things must be accomplished. First, you brighten the individual LED through these lines of code:
</p>
<p class='vspace'></p><p>
<div class='sourceblock ' id='sourceblock3'>
  <div class='sourceblocktext'><div class="arduino"><span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw1">int</span> brightness <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span> brightness <span class="sy0">&lt;</span> <span class="nu0">255</span><span class="sy0">;</span> brightness<span class="sy0">++</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span class="kw1">analogWrite</span><span class="br0">&#40;</span>thisPin<span class="sy0">,</span> brightness<span class="br0">&#41;</span><span class="sy0">;</span><br />
&nbsp; &nbsp; &nbsp; <span class="kw1">delay</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span><span class="sy0">;</span><br />
<span class="br0">&#125;</span></div></div>
  <div class='sourceblocklink'><a href='AnalogWriteMega2992.html?action=sourceblock&amp;num=3' type='text/plain'>[Get Code]</a></div>
</div>

</p>
<p class='vspace'></p><p>With each pass through the loop above, the variable brightness increases by one point, and that value is  written to the pin currently selected to the main loop. One that pin reaches the maximum PWM value (255), the following loop kicks in:
</p>
<p class='vspace'></p><p>
<div class='sourceblock ' id='sourceblock4'>
  <div class='sourceblocktext'><div class="arduino"><span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw1">int</span> brightness <span class="sy0">=</span> <span class="nu0">255</span><span class="sy0">;</span> brightness <span class="sy0">&gt;=</span> <span class="nu0">0</span><span class="sy0">;</span> brightness<span class="sy0">--</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span class="kw1">analogWrite</span><span class="br0">&#40;</span>thisPin<span class="sy0">,</span> brightness<span class="br0">&#41;</span><span class="sy0">;</span><br />
&nbsp; &nbsp; &nbsp; <span class="kw1">delay</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span><span class="sy0">;</span><br />
<span class="br0">&#125;</span></div></div>
  <div class='sourceblocklink'><a href='AnalogWriteMega0c37.html?action=sourceblock&amp;num=4' type='text/plain'>[Get Code]</a></div>
</div>

</p>
<p class='vspace'></p><p>This loop subtracts a point from the brightness variable, dimming the LED back down to 0. Once zero is reached, the main <code>for()</code> loop kicks in, and the program moves on to the next LED pin, repeating all the steps mentioned above. 
</p>
<p class='vspace'></p><div  class='code' >
<p>
<div class='sourceblock ' id='sourceblock1'>
  <div class='sourceblocktext'><div class="arduino"><span class="coMULTI">/*<br />
&nbsp; Mega analogWrite() test<br />
&nbsp; &nbsp; <br />
&nbsp; This sketch fades LEDs up and down one at a time on digital pins 2 through 13. &nbsp;<br />
&nbsp; This sketch was written for the Arduino Mega, and will not work on previous boards.<br />
&nbsp; &nbsp; <br />
&nbsp; The circuit:<br />
&nbsp; * LEDs attached from pins 2 through 13 to ground.<br />
<br />
&nbsp; created 8 Feb 2009<br />
&nbsp; by Tom Igoe<br />
&nbsp; <br />
&nbsp; This example code is in the public domain.<br />
&nbsp; <br />
&nbsp;*/</span><br />
<span class="co1">// These constants won't change. &nbsp;They're used to give names</span><br />
<span class="co1">// to the pins used:</span><br />
const <span class="kw1">int</span> lowestPin <span class="sy0">=</span> <span class="nu0">2</span><span class="sy0">;</span><br />
const <span class="kw1">int</span> highestPin <span class="sy0">=</span> <span class="nu0">13</span><span class="sy0">;</span><br />
<br />
<br />
<span class="kw1">void</span> <span class="kw3">setup</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />
&nbsp; <span class="co1">// set pins 2 through 13 as outputs:</span><br />
&nbsp; <span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw1">int</span> thisPin <span class="sy0">=</span>lowestPin<span class="sy0">;</span> thisPin <span class="sy0">&lt;=</span> highestPin<span class="sy0">;</span> thisPin<span class="sy0">++</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <br />
&nbsp; &nbsp; <span class="kw1">pinMode</span><span class="br0">&#40;</span>thisPin<span class="sy0">,</span> <span class="kw2">OUTPUT</span><span class="br0">&#41;</span><span class="sy0">;</span> <br />
&nbsp; <span class="br0">&#125;</span><br />
<span class="br0">&#125;</span><br />
<br />
<span class="kw1">void</span> <span class="kw3">loop</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />
&nbsp; <span class="co1">// iterate over the pins:</span><br />
&nbsp; <span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw1">int</span> thisPin <span class="sy0">=</span>lowestPin<span class="sy0">;</span> thisPin <span class="sy0">&lt;=</span> highestPin<span class="sy0">;</span> thisPin<span class="sy0">++</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <br />
&nbsp; &nbsp; <span class="co1">// fade the LED on thisPin from off to brightest:</span><br />
&nbsp; &nbsp; <span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw1">int</span> brightness <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span> brightness <span class="sy0">&lt;</span> <span class="nu0">255</span><span class="sy0">;</span> brightness<span class="sy0">++</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span class="kw1">analogWrite</span><span class="br0">&#40;</span>thisPin<span class="sy0">,</span> brightness<span class="br0">&#41;</span><span class="sy0">;</span><br />
&nbsp; &nbsp; &nbsp; <span class="kw1">delay</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span><span class="sy0">;</span><br />
&nbsp; &nbsp; <span class="br0">&#125;</span> <br />
&nbsp; &nbsp; <span class="co1">// fade the LED on thisPin from brithstest to off:</span><br />
&nbsp; &nbsp; <span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw1">int</span> brightness <span class="sy0">=</span> <span class="nu0">255</span><span class="sy0">;</span> brightness <span class="sy0">&gt;=</span> <span class="nu0">0</span><span class="sy0">;</span> brightness<span class="sy0">--</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />
&nbsp; &nbsp; &nbsp; <span class="kw1">analogWrite</span><span class="br0">&#40;</span>thisPin<span class="sy0">,</span> brightness<span class="br0">&#41;</span><span class="sy0">;</span><br />
&nbsp; &nbsp; &nbsp; <span class="kw1">delay</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span><span class="sy0">;</span><br />
&nbsp; &nbsp; <span class="br0">&#125;</span> <br />
&nbsp; &nbsp; <span class="co1">// pause between LEDs:</span><br />
&nbsp; &nbsp; <span class="kw1">delay</span><span class="br0">&#40;</span><span class="nu0">100</span><span class="br0">&#41;</span><span class="sy0">;</span><br />
&nbsp; <span class="br0">&#125;</span><br />
<span class="br0">&#125;</span></div></div>
  <div class='sourceblocklink'><a href='AnalogWriteMegaf687.html?action=sourceblock&amp;num=1' type='text/plain'>[Get Code]</a></div>
</div>

</p></div>
<p class='vspace'></p><h3>See Also:</h3>
<ul><li><a class='wikilink' href='../Reference/For.html'>for</a>()
</li><li><a class='wikilink' href='../Reference/AnalogWrite.html'>analogWrite</a>()
</li><li><a class='wikilink' href='../Reference/Delay.html'>delay</a>()
<p class='vspace'></p></li><li><a class='wikilink' href='AnalogInput.html'>AnalogInput</a> - use a potentiometer to control the blinking of an LED
</li><li><a class='wikilink' href='AnalogInOutSerialhtml.html'>AnalogInOutSerial</a> - read an analog pin, map the result, and use that data to dim or brighten an LED
</li><li><a class='wikilink' href='Fade.html'>Fade</a> - use an analog input to fade an LED
</li><li><a class='wikilink' href='Calibration.html'>Calibration</a> - calibrating analog sensor readings
</li><li><a class='wikilink' href='ForLoop.html'>ForLoop</a> - How to use a <code>for()</code> loop (aka Knight Rider)
</li></ul><p class='vspace'></p>
</div>


<!-- AddThis Button BEGIN -->
<script type="text/javascript">var addthis_language = "en";
</script>
<div class="addthis_container addthis_toolbox addthis_default_style" addthis:url="http://arduino.cc/en/Tutorial/AnalogWriteMega" addthis:title="Arduino Wiki English">
<a href="http://www.addthis.com/bookmark.php?v=250&amp;username=arduinoteam" class="addthis_button_compact">Share</a><span 
class="addthis_separator">|</span><a class="addthis_button_email"></a><a class="addthis_button_favorites"></a><a class="addthis_button_print"></a><a 
class="addthis_button_facebook"></a><a class="addthis_button_twitter"></a><script type="text/javascript" 
src="../../../s7.addthis.com/js/250/addthis_widget.js#username=arduinoteam"></script></div>
<!-- AddThis Button END -->

</div>
<!--PageFooterFmt-->
<div id="pagefooter">
&copy;Arduino | 
  <a href='AnalogWriteMega264b.html?action=edit'>Edit Page</a> | <a href='AnalogWriteMegaad68.html?action=diff'>Page History</a> | <a href='AnalogWriteMega60ee.html?action=print' target='_blank'>Printable View</a> | <a href='../Site/AllRecentChanges.html'>All Recent Site Changes</a>
</div>
<!--/PageFooterFmt-->
</div>

<!-- Piwik -->
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? 
"https://stats.arduino.cc/piwik/" : "http://stats.arduino.cc/piwik/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 1);
piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
</script><noscript><p><img 
src="http://stats.arduino.cc/piwik/piwik.php?idsite=1" style="border:0" 
alt="" /></p></noscript>
<!-- End Piwik Tracking Code -->

</body>
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
</html>
