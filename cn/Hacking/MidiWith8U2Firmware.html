<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
  <title>Arduino - MidiWith8U2Firmware </title>
  <link rel="shortcut icon" type="image/x-icon" href="../favicon.png">
  <link rel='stylesheet' href='../pub/skins/arduinoWide_SSO/arduinoWide_SSO.css' 
type='text/css' />
  <link href="https://plus.google.com/114839908922424087554" rel="publisher" />
    <!--HeaderText--><style type='text/css'><!--
  ul, ol, pre, dl, p { margin-top:0px; margin-bottom:0px; }
  code { white-space: nowrap; }
  .vspace { margin-top:1.33em; }
  .indent { margin-left:40px; }
  .outdent { margin-left:40px; text-indent:-40px; }
  a.createlinktext { text-decoration:none; border-bottom:1px dotted gray; }
  a.createlink { text-decoration:none; position:relative; top:-0.5em;
    font-weight:bold; font-size:smaller; border-bottom:none; }
  img { border:0px; }
  
span.anchor {
	float: left;
	font-size: 10px;
	margin-left: -10px;
	width: 10px;
    position:relative; top:-0.1em;
	text-align: center;
}
span.anchor a { text-decoration: none; }
span.anchor a:hover { text-decoration: underline; }
ol.toc { text-indent:-20px; list-style: none; }
ol.toc ol.toc { text-indent:-40px; }
div.tocfloat { font-size: smaller; margin-bottom: 10px;
    border-top: 1px dotted #555555; border-bottom: 1px dotted #555555;
    padding-top: 5px; padding-bottom: 5px; 
    width: 38%; float: right; margin-left: 10px; clear: right;
    margin-right:-13px; padding-right: 13px; padding-left: 13px;
    background-color: #eeeeee; }
div.toc { font-size: smaller; 
    padding: 5px; border: 1px dotted #cccccc;
    background: #f7f7f7;
    margin-bottom: 10px; }
div.toc p { background-color: #f9f6d6;
    margin-top:-5px;   padding-top: 5px;
    margin-left:-5px;  padding-left: 5px;
    margin-right:-5px; padding-right: 5px;
    padding-bottom: 3px;
    border-bottom:  1px dotted #cccccc; }.editconflict { color:green; 
  font-style:italic; margin-top:1.33em; margin-bottom:1.33em; }

  table.markup { border: 2px dotted #ccf; width:90%; }
  td.markup1, td.markup2 { padding-left:10px; padding-right:10px; }
  td.markup1 { border-bottom: 1px solid #ccf; }
  div.faq { margin-left:2em; }
  div.faq p.question { margin: 1em 0 0.75em -2em; font-weight:bold; }
  div.faq hr { margin-left: -2em; }
   
    .frame 
      { border:1px solid #cccccc; padding:4px; background-color:#f9f9f9; }
    .lfloat { float:left; margin-right:0.5em; }
    .rfloat { float:right; margin-left:0.5em; }
a.varlink { text-decoration:none; }
/**
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 */
.arduino  {font-family:monospace;}
.arduino .imp {font-weight: bold; color: red;}
.arduino .kw1 {color: #CC6600;}
.arduino .kw2 {color: #006699;}
.arduino .kw3 {color: #CC6600; font-weight: bold;}
.arduino .co1 {color: #7E7E7E; font-style: italic;}
.arduino .co2 {color: #7E7E7E;}
.arduino .coMULTI {color: #7E7E7E; font-style: italic;}
.arduino .es0 {color: #000099; font-weight: bold;}
.arduino .es1 {color: #000099; font-weight: bold;}
.arduino .es2 {color: #660099; font-weight: bold;}
.arduino .es3 {color: #660099; font-weight: bold;}
.arduino .es4 {color: #660099; font-weight: bold;}
.arduino .es5 {color: #006699; font-weight: bold;}
.arduino .br0 {color: #000000;}
.arduino .sy0 {color: #000000;}
.arduino .st0 {color: #0066CC;}
.arduino .nu0 {color: #000000;}
.arduino .nu6 {color: #208080;}
.arduino .nu8 {color: #208080;}
.arduino .nu12 {color: #208080;}
.arduino .nu16 {color:#800080;}
.arduino .nu17 {color:#800080;}
.arduino .nu18 {color:#800080;}
.arduino .nu19 {color:#800080;}
.arduino .me1 {color: #ff1493;}
.arduino .me2 {color: #ff1493;}
.arduino span.xtra { display:block; }

.sourceblocklink {
  text-align: right;
  font-size: smaller;
}
.sourceblocktext {
  padding: 0.5em;
  color: #000000;
  background-color: #ffffff;
}
.sourceblocktext div {
  font-family: monospace;
  font-size: small;
  line-height: 1;
  height: 1%;
}
.sourceblocktext div.head,
.sourceblocktext div.foot {
  font: italic medium serif;
  padding: 0.5em;
}

--></style><script type="text/javascript">
function toggle(obj) {
    var elstyle = document.getElementById(obj).style;
    var text    = document.getElementById(obj + "tog");
    if (elstyle.display == 'none') {
        elstyle.display = 'block';
        text.innerHTML = "hide";
    } else {
        elstyle.display = 'none';
        text.innerHTML = "show";
    }
}
</script>  <meta name='robots' content='index,follow' />

  <meta name="verify-v1" content="TtxFIEJAB6zdJ509wLxjnapQzKAMNm9u0Wj4ho6wxIY=" />
  <script src="https://id.arduino.cc/css/sso_bar_js_2.php?s=reference"></script>
  <link rel="stylesheet" type="text/css" media="screen" href="../../../id.arduino.cc/css/sso_bar.css" />
</head>
<body>

		<div id="ssotoolbar">
		  <div id="al">
			<nobr><div id="ssoNavBar">&nbsp;</div></nobr>
		  </div>
		  <div id="ar">
			<nobr>
			  <div id="loginInfo"><div id="loading">Loading...</div></div>
			</nobr>
		  </div>
		</div>
		<script>ssoGenerateNavigationBar('');</script>
<div id="page">
<!--PageHeaderFmt-->
<div id="pageheader">
  <div class="title"><a href='../../en.html'>Arduino</a></div>
  <div class="search">
    <!-- SiteSearch Google -->
    <FORM method=GET action="http://www.google.com/search">
    <input type=hidden name=ie value=UTF-8>
    <input type=hidden name=oe value=UTF-8>
    <INPUT TYPE=text name=q size=25 maxlength=255 value="">
    <INPUT type=submit name=btnG VALUE="search">
    <input type=hidden name=domains value="http://arduino.cc/">
    <input type=hidden name=sitesearch value="http://arduino.cc/">
    </FORM>
    <!-- SiteSearch Google -->
  </div>
</div>
<!--/PageHeaderFmt-->
<!--PageLeftFmt-->
<div id="pagenav">
  <div id="navbar">
  	<p><a class='wikilink' href='../Main/Buy.html'>Buy</a>
<a class='wikilink' href='../Main/Software.html'>Download</a>
<a class='wikilink' href='../Guide/HomePage.html'>Getting Started</a>
<a class='wikilink' href='../Tutorial/HomePage.html'>Learning</a>
<a class='wikilink' href='../Reference/HomePage.html'>Reference</a>
<a class='wikilink' href='../Main/Hardware.html'>Hardware</a>
<a class='wikilink' href='../Main/FAQ.html'>FAQ</a>
</p>
<p class='vspace'></p>

  </div>
</div>
<!--/PageLeftFmt-->
<div id="pagetext">
<!--PageText-->
<div id='wikitext'>
<p><strong>Learning</strong> &nbsp;  <a class='wikilink' href='../Tutorial/HomePage.html'>Examples</a> | <a class='wikilink' href='../Tutorial/Foundations.html'>Foundations</a> | <a class='wikilink' href='HomePage.html'>Hacking</a> | <a class='wikilink' href='../Tutorial/Links.html'>Links</a>
</p>
<p class='vspace'></p><h3>MIDI Note Player using the MIDI firmware for the 8U2 (Uno and Mega2560 only)</h3>
<p>This tutorial shows how to play MIDI notes from an Arduino programmed to appear as a general MIDI device. This tutorial is only applicable to Arduinos with the 8U2 chip, the UNO and Mega2560 boards. This will not work with earlier models that use the FTDI chip (Duemilanove and previous).
</p>
<p class='vspace'></p><p>Following the instructions on the <a class='wikilink' href='DFUProgramming8U2.html'>Programming 8U2</a> instructions using the <a class='urllink' href='http://web.mac.com/kuwatay/morecat_lab./MocoLUFA.html' rel='nofollow'>MocoLUFA</a> firmware, your Arduino will appear to the computer as a native MIDI device without any additional hardware. 
</p>
<p class='vspace'></p><p>You can read the Wikipedia <a class='urllink' href='http://en.wikipedia.org/wiki/MIDI' rel='nofollow'>MIDI</a> entry for complete information on the specification, but in a nutshell, MIDI is a useful protocol for controlling synthesizers, sequencers, and other musical devices. MIDI devices are generally grouped in two broad classes: controllers (i.e. devices that generate MIDI signals based on human actions) and synthesizers (including samplers, sequencers, and so forth).
</p>
<p class='vspace'></p><p>For more information, see this <a class='urllink' href='http://www.tigoe.net/pcomp/code/communication/midi' rel='nofollow'>introduction to MIDI</a> or this <a class='urllink' href='http://itp.nyu.edu/physcomp/Labs/MIDIOutput' rel='nofollow'>example</a>.
</p>
<p class='vspace'></p><p>The Serial.print() function will send a MIDI command to the software synthesizer of your choice (in this example we will use Cycling74's Max/MSP, but any application that accepts MIDI will do). 
</p>
<p class='vspace'></p><p>Before programming the 8U2 firmware, you will need to program the Atmega 328 on your Arduino, the same way you usually do with the IDE. We will be using the MIDI communication example that comes with the Arduino software. It can be found in File&gt;Examples&gt;Communication&gt;MIDI.
</p>
<p class='vspace'></p><h3>Code</h3>
<div  class='code' >
<p>
<div class='sourceblock ' id='sourceblock1'>
  <div class='sourceblocktext'><div class="arduino"><span class="coMULTI">/*<br />
&nbsp;MIDI note player<br />
&nbsp;<br />
&nbsp;This sketch shows how to use the serial transmit pin (pin 1) to send MIDI note data.<br />
&nbsp;If this circuit is connected to a MIDI synth, it will play <br />
&nbsp;the notes F#-0 (0x1E) to F#-5 (0x5A) in sequence.<br />
<br />
&nbsp;<br />
&nbsp;The circuit:<br />
&nbsp;* digital in 1 connected to MIDI jack pin 5<br />
&nbsp;* MIDI jack pin 2 connected to ground<br />
&nbsp;* MIDI jack pin 4 connected to +5V through 220-ohm resistor<br />
&nbsp;Attach a MIDI cable to the jack, then to a MIDI synth, and play music.<br />
<br />
&nbsp;created 13 Jun 2006<br />
&nbsp;modified 30 Aug 2011<br />
&nbsp;by Tom Igoe <br />
<br />
&nbsp;This example code is in the public domain.<br />
&nbsp;<br />
&nbsp;http://arduino.cc/en/Tutorial/MIDI<br />
&nbsp;<br />
&nbsp;*/</span><br />
<br />
<span class="kw1">void</span> <span class="kw3">setup</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />
&nbsp; <span class="co1">// &nbsp;Set MIDI baud rate:</span><br />
&nbsp; <span class="kw1">Serial</span>.<span class="kw1">begin</span><span class="br0">&#40;</span><span class="nu0">31250</span><span class="br0">&#41;</span><span class="sy0">;</span><br />
<span class="br0">&#125;</span><br />
<br />
<span class="kw1">void</span> <span class="kw3">loop</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />
&nbsp; <span class="co1">// play notes from F#-0 (0x1E) to F#-5 (0x5A):</span><br />
&nbsp; <span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw1">int</span> note <span class="sy0">=</span> <span class="nu12">0x1E</span><span class="sy0">;</span> note <span class="sy0">&lt;</span> <span class="nu12">0x5A</span><span class="sy0">;</span> note <span class="sy0">++</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br />
&nbsp; &nbsp; <span class="co1">//Note on channel 1 (0x90), some note value (note), middle velocity (0x45):</span><br />
&nbsp; &nbsp; noteOn<span class="br0">&#40;</span><span class="nu12">0x90</span><span class="sy0">,</span> note<span class="sy0">,</span> <span class="nu12">0x45</span><span class="br0">&#41;</span><span class="sy0">;</span><br />
&nbsp; &nbsp; <span class="kw1">delay</span><span class="br0">&#40;</span><span class="nu0">100</span><span class="br0">&#41;</span><span class="sy0">;</span><br />
&nbsp; &nbsp; <span class="co1">//Note on channel 1 (0x90), some note value (note), silent velocity (0x00):</span><br />
&nbsp; &nbsp; noteOn<span class="br0">&#40;</span><span class="nu12">0x90</span><span class="sy0">,</span> note<span class="sy0">,</span> <span class="nu12">0x00</span><span class="br0">&#41;</span><span class="sy0">;</span> &nbsp; <br />
&nbsp; &nbsp; <span class="kw1">delay</span><span class="br0">&#40;</span><span class="nu0">100</span><span class="br0">&#41;</span><span class="sy0">;</span><br />
&nbsp; <span class="br0">&#125;</span><br />
<span class="br0">&#125;</span><br />
<br />
<span class="co1">// &nbsp;plays a MIDI note. &nbsp;Doesn't check to see that</span><br />
<span class="co1">// &nbsp;cmd is greater than 127, or that data values are &nbsp;less than 127:</span><br />
<span class="kw1">void</span> noteOn<span class="br0">&#40;</span><span class="kw1">int</span> cmd<span class="sy0">,</span> <span class="kw1">int</span> pitch<span class="sy0">,</span> <span class="kw1">int</span> velocity<span class="br0">&#41;</span> <span class="br0">&#123;</span><br />
&nbsp; <span class="kw1">Serial</span>.<span class="kw1">write</span><span class="br0">&#40;</span>cmd<span class="br0">&#41;</span><span class="sy0">;</span><br />
&nbsp; <span class="kw1">Serial</span>.<span class="kw1">write</span><span class="br0">&#40;</span>pitch<span class="br0">&#41;</span><span class="sy0">;</span><br />
&nbsp; <span class="kw1">Serial</span>.<span class="kw1">write</span><span class="br0">&#40;</span>velocity<span class="br0">&#41;</span><span class="sy0">;</span><br />
<span class="br0">&#125;</span></div></div>
  <div class='sourceblocklink'><a href='MidiWith8U2Firmwaref687.html?action=sourceblock&amp;num=1' type='text/plain'>[Get Code]</a></div>
</div>

</p></div>
<p class='vspace'></p><p>Program your Arduino, and prepare to program the 8U2 chip. Follow  the instructions on the <a class='wikilink' href='DFUProgramming8U2.html'>Programming 8U2</a> page, replacing the Arduino firmware with the <a class='urllink' href='http://web.mac.com/kuwatay/morecat_lab./MocoLUFA.html' rel='nofollow'>MocoLUFA</a> firmware.
</p>
<p class='vspace'></p><p>After the 8U2 has been updated with the MIDI firmware, disconnect and reconnect the USB cable. 
</p>
<p class='vspace'></p><p>Open your MIDI application of choice and look for connected devices. You should see the Arduino appear as an input and output device named "MIDI/MOCO for LUFA".
</p>
<p class='vspace'></p><div><img src='../uploads/Hacking/MIDI_device_list.png' alt='' title='' /></div>
<p class='vspace'></p><p>A simple Max patch that will allow you to hear the notes generated by the MIDI commands looks like this : 
</p>
<p class='vspace'></p><div><img src='../uploads/Hacking/MIDI_MaxPatch.png' alt='' title='' /></div>
<p class='vspace'></p><p>To change the program on the Arduino, you must first reset the firmware on the 8U2 to the Arduino's default.
</p>
<p class='vspace'></p><p><strong>See Also:</strong>
</p>
<p class='vspace'></p><ul><li><a class='wikilink' href='../Tutorial/Midi.html'>MIDI</a>
</li></ul>
</div>


<!-- AddThis Button BEGIN -->
<script type="text/javascript">var addthis_language = "en";
</script>
<div class="addthis_container addthis_toolbox addthis_default_style" addthis:url="http://arduino.cc/en/Hacking/MidiWith8U2Firmware" addthis:title="Arduino Wiki English">
<a href="http://www.addthis.com/bookmark.php?v=250&amp;username=arduinoteam" class="addthis_button_compact">Share</a><span 
class="addthis_separator">|</span><a class="addthis_button_email"></a><a class="addthis_button_favorites"></a><a class="addthis_button_print"></a><a 
class="addthis_button_facebook"></a><a class="addthis_button_twitter"></a><script type="text/javascript" 
src="../../../s7.addthis.com/js/250/addthis_widget.js#username=arduinoteam"></script></div>
<!-- AddThis Button END -->

</div>
<!--PageFooterFmt-->
<div id="pagefooter">
&copy;Arduino | 
  <a href='MidiWith8U2Firmware264b.html?action=edit'>Edit Page</a> | <a href='MidiWith8U2Firmwaread68.html?action=diff'>Page History</a> | <a href='MidiWith8U2Firmware60ee.html?action=print' target='_blank'>Printable View</a> | <a href='../Site/AllRecentChanges.html'>All Recent Site Changes</a>
</div>
<!--/PageFooterFmt-->
</div>

<!-- Piwik -->
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? 
"https://stats.arduino.cc/piwik/" : "http://stats.arduino.cc/piwik/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 1);
piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
</script><noscript><p><img 
src="http://stats.arduino.cc/piwik/piwik.php?idsite=1" style="border:0" 
alt="" /></p></noscript>
<!-- End Piwik Tracking Code -->

</body>
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
</html>
